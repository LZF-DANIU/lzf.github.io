<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¡¹ç›®ç®¡ç†ç³»ç»Ÿ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
        }
        
        .container {
            display: flex;
            height: 100vh;
        }
        
        .sidebar {
            width: 220px;
            background-color: #2c3e50;
            color: white;
            padding: 20px 0;
            height: 100%;
        }
        
        .sidebar-header {
            padding: 0 20px 20px 20px;
            border-bottom: 1px solid #3d5166;
        }
        
        .sidebar-header h2 {
            margin: 0;
            font-size: 18px;
        }
        
        .sidebar-menu {
            list-style: none;
            padding: 0;
            margin: 20px 0;
        }
        
        .sidebar-menu li {
            padding: 10px 20px;
            cursor: pointer;
        }
        
        .sidebar-menu li:hover, .sidebar-menu li.active {
            background-color: #3d5166;
        }
        
        .sidebar-menu li i {
            margin-right: 10px;
        }
        
        .main-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .search-bar {
            display: flex;
            align-items: center;
            background-color: white;
            border-radius: 4px;
            padding: 8px 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            width: 300px;
        }
        
        .search-bar input {
            border: none;
            outline: none;
            flex: 1;
            margin-left: 10px;
        }
        
        .user-profile {
            display: flex;
            align-items: center;
        }
        
        .user-profile img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 10px;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .card {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .card-title {
            margin: 0;
            font-size: 16px;
            color: #333;
        }
        
        .card-value {
            font-size: 24px;
            font-weight: bold;
            margin: 0;
        }
        
        .table-container {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        th {
            font-weight: 600;
            color: #555;
        }
        
        tr:last-child td {
            border-bottom: none;
        }
        
        .status {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .status-completed {
            background-color: #e6f7ee;
            color: #0abb75;
        }
        
        .status-in-progress {
            background-color: #fff8e6;
            color: #ffb100;
        }
        
        .status-pending {
            background-color: #f0f0f0;
            color: #777;
        }
        
        .status-delayed {
            background-color: #ffe6e6;
            color: #ff4d4d;
        }
        
        /* éšè—æ¸¸æˆåŒºåŸŸ */
        .game-container {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            z-index: 1000;
            width: 80%;
            max-width: 800px;
            height: 80%;
            max-height: 600px;
            overflow: auto;
        }
        
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .close-game {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
        }
        
        .game-content {
            height: calc(100% - 50px);
            overflow: auto;
        }
        
        /* ç´§æ€¥å…³é—­æŒ‰é’® */
        .emergency-close {
            position: fixed;
            top: 10px;
            right: 10px;
            background-color: #ff4d4d;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 5px 10px;
            cursor: pointer;
            display: none;
            z-index: 1001;
        }
        
        /* 2048æ¸¸æˆæ ·å¼ */
        .game-2048 {
            width: 100%;
            max-width: 500px;
            margin: 0 auto;
        }
        
        .game-header-2048 {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        
        .score-container {
            background-color: #bbada0;
            padding: 10px 15px;
            border-radius: 5px;
            color: white;
            font-weight: bold;
            text-align: center;
        }
        
        .grid-container {
            background-color: #bbada0;
            border-radius: 6px;
            padding: 15px;
            position: relative;
            margin: 0 auto;
        }
        
        .grid-row {
            display: flex;
            margin-bottom: 15px;
        }
        
        .grid-row:last-child {
            margin-bottom: 0;
        }
        
        .grid-cell {
            width: 100px;
            height: 100px;
            margin-right: 15px;
            background-color: #cdc1b4;
            border-radius: 5px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 36px;
            font-weight: bold;
            color: #776e65;
        }
        
        .grid-cell:last-child {
            margin-right: 0;
        }
        
        .tile-2 { background-color: #eee4da; }
        .tile-4 { background-color: #ede0c8; }
        .tile-8 { background-color: #f2b179; color: white; }
        .tile-16 { background-color: #f59563; color: white; }
        .tile-32 { background-color: #f67c5f; color: white; }
        .tile-64 { background-color: #f65e3b; color: white; }
        .tile-128 { background-color: #edcf72; color: white; font-size: 32px; }
        .tile-256 { background-color: #edcc61; color: white; font-size: 32px; }
        .tile-512 { background-color: #edc850; color: white; font-size: 32px; }
        .tile-1024 { background-color: #edc53f; color: white; font-size: 28px; }
        .tile-2048 { background-color: #edc22e; color: white; font-size: 28px; }
        
        /* è´ªåƒè›‡æ¸¸æˆæ ·å¼ */
        .game-snake {
            width: 100%;
            max-width: 500px;
            margin: 0 auto;
        }
        
        .snake-board {
            width: 400px;
            height: 400px;
            border: 3px solid #4CAF50;
            border-radius: 12px;
            margin: 0 auto;
            position: relative;
            background-color: #f8f8f8;
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
            overflow: hidden;
            background-image: linear-gradient(rgba(76, 175, 80, 0.05) 1px, transparent 1px), linear-gradient(90deg, rgba(76, 175, 80, 0.05) 1px, transparent 1px);
            background-size: 20px 20px;
        }
        
        .snake-controls {
            display: flex;
            justify-content: center;
            margin-top: 20px;
        }
        
        .snake-controls button {
            margin: 0 10px;
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.2s ease;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        .snake-controls button:hover {
            background-color: #3d8b40;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .snake-controls button:active {
            transform: translateY(0);
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }
        
        .snake-score {
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            padding: 10px 20px;
            background-color: #f0f0f0;
            border-radius: 30px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            display: inline-block;
        }
        
        .snake-instructions {
            text-align: center;
            margin-top: 15px;
            color: #555;
        }
        
        .snake-instructions p {
            margin-bottom: 10px;
        }
        
        .touch-controls {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 10px;
            max-width: 200px;
            margin: 0 auto;
        }
        
        .touch-controls-middle {
            display: flex;
            justify-content: space-between;
            width: 100%;
            margin: 5px 0;
        }
        
        .touch-controls button {
            width: 60px;
            height: 60px;
            background-color: rgba(76, 175, 80, 0.8);
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 24px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 3px 6px rgba(0,0,0,0.2);
        }
        
        .touch-controls button:hover {
            background-color: rgba(76, 175, 80, 1);
            transform: scale(1.1);
            box-shadow: 0 5px 10px rgba(0,0,0,0.3);
        }
        
        .touch-controls button:active {
            transform: scale(0.95);
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        /* è›‡å’Œé£Ÿç‰©æ ·å¼ */
        .snake-head {
            background-color: #388E3C !important;
            border-radius: 6px !important;
            z-index: 10;
            box-shadow: 0 0 8px rgba(0,0,0,0.3);
            position: absolute;
            transition: all 0.15s ease;
        }
        
        .snake-body {
            background-color: #4CAF50 !important;
            border-radius: 4px !important;
            z-index: 5;
            position: absolute;
            transition: all 0.15s ease;
        }
        
        .snake-food {
            background-color: #FF5722 !important;
            border-radius: 50% !important;
            z-index: 8;
            position: absolute;
            box-shadow: 0 0 10px rgba(255, 87, 34, 0.6);
            animation: pulse 0.8s infinite alternate;
        }
        
        @keyframes pulse {
            from { transform: scale(0.9); box-shadow: 0 0 5px rgba(255, 87, 34, 0.6); }
            to { transform: scale(1.1); box-shadow: 0 0 15px rgba(255, 87, 34, 0.8); }
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 600px) {
            .snake-board {
                width: 300px;
                height: 300px;
                background-size: 15px 15px;
            }
            
            .touch-controls button {
                width: 50px;
                height: 50px;
                font-size: 20px;
            }
        }
        
        @media (max-width: 400px) {
            .snake-board {
                width: 250px;
                height: 250px;
                background-size: 12.5px 12.5px;
            }
            
            .snake-controls {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .touch-controls button {
                width: 40px;
                height: 40px;
                font-size: 16px;
            }
        }
        
        /* è¦†ç›–å±‚ */
        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 999;
        }
        
        .snake-body {
            position: absolute;
            background-color: #8BC34A;
            border-radius: 30%;
            transition: all 0.1s linear;
        }
        
        @keyframes pulse {
            from { transform: scale(0.95); box-shadow: 0 0 5px rgba(255, 87, 34, 0.7); }
            to { transform: scale(1.05); box-shadow: 0 0 15px rgba(255, 87, 34, 0.8); }
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 500px) {
            .snake-board {
                width: 300px;
                height: 300px;
            }
            
            .snake-controls button {
                padding: 8px 15px;
                font-size: 14px;
            }
            
            .snake-score {
                font-size: 20px;
            }
            
            .touch-controls button {
                width: 50px;
                height: 50px;
                font-size: 20px;
            }
        }
        
        /* è¦†ç›–å±‚ */
        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 999;
        }
        
        /* é¡¹ç›®ç®¡ç†æ ·å¼ */
        .projects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .project-card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 15px;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .project-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.15);
        }
        
        .project-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .project-header h3 {
            margin: 0;
            color: #2c3e50;
        }
        
        .project-status {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .project-info p {
            margin: 8px 0;
            font-size: 14px;
        }
        
        .project-progress {
            margin: 15px 0;
        }
        
        .progress-bar {
            height: 8px;
            background-color: #ecf0f1;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress {
            height: 100%;
            background-color: #3498db;
        }
        
        .project-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 15px;
        }
        
        .btn-view, .btn-edit, .btn-add-project, .btn-generate, .btn-export, .btn-save, #add-task-btn {
            cursor: pointer;
            border: none;
            border-radius: 4px;
            padding: 8px 15px;
            color: white;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        
        .btn-view {
            background-color: #2ecc71;
        }
        
        .btn-view:hover {
            background-color: #27ae60;
        }
        
        .btn-edit {
            background-color: #f39c12;
        }
        
        .btn-edit:hover {
            background-color: #e67e22;
        }
        
        .btn-add-project {
            display: block;
            margin: 20px auto;
            padding: 10px 20px;
            background-color: #3498db;
        }
        
        .btn-add-project:hover {
            background-color: #2980b9;
        }
        
        /* ä»»åŠ¡ç®¡ç†æ ·å¼ */
        .tasks-filter {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        
        .tasks-filter select, .tasks-filter input {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .tasks-filter input {
            flex: 1;
            margin-left: 15px;
        }
        
        .tasks-list {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .task-item {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
        }
        
        .task-item:last-child {
            border-bottom: none;
        }
        
        .task-item input[type="checkbox"] {
            margin-right: 10px;
        }
        
        .task-item label {
            flex: 1;
            margin-right: 15px;
        }
        
        .task-item label.completed {
            text-decoration: line-through;
            color: #999;
        }
        
        .task-due {
            margin-right: 15px;
            font-size: 14px;
            color: #666;
        }
        
        .task-priority {
            padding: 3px 8px;
            border-radius: 3px;
            font-size: 12px;
            font-weight: bold;
            color: white;
        }
        
        .task-priority.high {
            background-color: #e74c3c;
        }
        
        .task-priority.medium {
            background-color: #f39c12;
        }
        
        .task-priority.low {
            background-color: #3498db;
        }
        
        .add-task {
            display: flex;
            margin-top: 20px;
        }
        
        .add-task input {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px 0 0 4px;
            outline: none;
        }
        
        #add-task-btn {
            border-radius: 0 4px 4px 0;
            background-color: #3498db;
        }
        
        #add-task-btn:hover {
            background-color: #2980b9;
        }
        
        /* å›¢é˜Ÿæˆå‘˜æ ·å¼ */
        .team-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 20px;
        }
        
        .team-card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 20px;
            text-align: center;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .team-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.15);
        }
        
        .team-card img {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            margin-bottom: 15px;
        }
        
        .team-card h3 {
            margin: 0 0 5px 0;
            color: #2c3e50;
        }
        
        .team-role {
            color: #7f8c8d;
            margin: 0 0 10px 0;
        }
        
        .team-contact {
            font-size: 14px;
            color: #3498db;
            margin: 0 0 15px 0;
        }
        
        .team-projects {
            background-color: #f5f5f5;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .team-card.add-member {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            background-color: #f9f9f9;
            border: 2px dashed #ddd;
        }
        
        .add-icon {
            font-size: 30px;
            color: #3498db;
            margin-bottom: 10px;
        }
        
        /* æŠ¥è¡¨æ ·å¼ */
        .reports-filters {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .date-range, .report-type {
            display: flex;
            align-items: center;
        }
        
        .date-range label, .report-type label {
            margin-right: 10px;
            font-weight: bold;
        }
        
        .date-range select, .report-type select {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .btn-generate {
            background-color: #3498db;
        }
        
        .btn-generate:hover {
            background-color: #2980b9;
        }
        
        .reports-charts {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .chart-container {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 20px;
        }
        
        .chart-container h3 {
            margin-top: 0;
            margin-bottom: 15px;
            color: #2c3e50;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        
        .chart-placeholder {
            height: 250px;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            align-items: center;
        }
        
        .bar-chart {
            display: flex;
            align-items: flex-end;
            height: 200px;
            width: 100%;
            justify-content: space-around;
        }
        
        .bar {
            width: 40px;
            background-color: #3498db;
            border-radius: 4px 4px 0 0;
            position: relative;
            transition: height 0.5s;
        }
        
        .bar span {
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 12px;
            white-space: nowrap;
        }
        
        .chart-axis {
            margin-top: 30px;
            font-size: 14px;
            color: #7f8c8d;
        }
        
        .pie-chart {
            position: relative;
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: conic-gradient(
                #4CAF50 0% 25%,
                #2196F3 25% 70%,
                #FFC107 70% 85%,
                #9E9E9E 85% 100%
            );
        }
        
        .pie-segment {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: white;
            font-size: 14px;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }
        
        .reports-summary {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .reports-summary h3 {
            margin-top: 0;
            margin-bottom: 15px;
            color: #2c3e50;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        
        .reports-summary ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .reports-summary li {
            margin-bottom: 10px;
            font-size: 16px;
        }
        
        .btn-export {
            display: block;
            margin: 0 auto;
            padding: 10px 20px;
            background-color: #27ae60;
        }
        
        .btn-export:hover {
            background-color: #219653;
        }
        
        /* è®¾ç½®æ ·å¼ */
        .settings-section {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .settings-section h3 {
            margin-top: 0;
            margin-bottom: 15px;
            color: #2c3e50;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        
        .settings-form .form-group {
            margin-bottom: 15px;
        }
        
        .settings-form label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .settings-form input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .btn-save {
            background-color: #27ae60;
            margin-top: 10px;
        }
        
        .btn-save:hover {
            background-color: #219653;
        }
        
        .settings-options {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .option-item {
            display: flex;
            align-items: center;
        }
        
        .option-item input[type="checkbox"] {
            margin-right: 10px;
        }
        
        .theme-options {
            display: flex;
            gap: 20px;
        }
        
        .theme-option {
            text-align: center;
            cursor: pointer;
        }
        
        .theme-preview {
            width: 80px;
            height: 50px;
            border-radius: 4px;
            margin-bottom: 5px;
            border: 2px solid transparent;
        }
        
        .theme-option.active .theme-preview {
            border-color: #3498db;
        }
        
        .theme-preview.light {
            background-color: #f5f5f5;
        }
        
        .theme-preview.dark {
            background-color: #2c3e50;
        }
        
        .theme-preview.blue {
            background-color: #3498db;
        }
        
        .language-select {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            width: 200px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="sidebar">
            <div class="sidebar-header">
                <h2>é¡¹ç›®ç®¡ç†ç³»ç»Ÿ</h2>
            </div>
            <ul class="sidebar-menu">
                <li class="active" onclick="showDashboard('ğŸ“Š ä»ªè¡¨ç›˜')"><i>ğŸ“Š</i> ä»ªè¡¨ç›˜</li>
                <li onclick="showDashboard('ğŸ“‹ é¡¹ç›®')"><i>ğŸ“‹</i> é¡¹ç›®</li>
                <li onclick="showDashboard('âœ… ä»»åŠ¡')"><i>âœ…</i> ä»»åŠ¡</li>
                <li onclick="showDashboard('ğŸ‘¥ å›¢é˜Ÿ')"><i>ğŸ‘¥</i> å›¢é˜Ÿ</li>
                <li onclick="showDashboard('ğŸ“ˆ æŠ¥è¡¨')"><i>ğŸ“ˆ</i> æŠ¥è¡¨</li>
                <li onclick="showDashboard('âš™ï¸ è®¾ç½®')"><i>âš™ï¸</i> è®¾ç½®</li>
                <li onclick="toggleGame('2048')"><i>ğŸ®</i> <span class="hidden-menu">å¤§å±</span></li>
                <li onclick="toggleGame('snake')"><i>ğŸ</i> <span class="hidden-menu">æŠ¥è¡¨</span></li>
            </ul>
        </div>
        
        <div class="main-content">
            <div class="header">
                <div class="search-bar">
                    <i>ğŸ”</i>
                    <input type="text" placeholder="æœç´¢é¡¹ç›®ã€ä»»åŠ¡æˆ–æ–‡æ¡£...">
                </div>
                <div class="user-profile">
                    <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSIxMDAiIGN5PSIxMDAiIHI9IjEwMCIgZmlsbD0iIzJjM2U1MCIvPjxjaXJjbGUgY3g9IjEwMCIgY3k9IjgwIiByPSI0MCIgZmlsbD0iI2VjZjBmMSIvPjxwYXRoIGQ9Ik0xNjAgMTgwYzAtMzMuMTM3LTI2Ljg2My02MC02MC02MHMtNjAgMjYuODYzLTYwIDYwIiBmaWxsPSIjZWNmMGYxIi8+PC9zdmc+" alt="ç”¨æˆ·å¤´åƒ">
                    <span>ç”¨æˆ·å</span>
                </div>
            </div>
            
            <div class="dashboard">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">è¿›è¡Œä¸­çš„é¡¹ç›®</h3>
                        <span>ğŸ“ˆ</span>
                    </div>
                    <p class="card-value">12</p>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">å¾…å¤„ç†ä»»åŠ¡</h3>
                        <span>ğŸ“</span>
                    </div>
                    <p class="card-value">24</p>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">å›¢é˜Ÿæˆå‘˜</h3>
                        <span>ğŸ‘¥</span>
                    </div>
                    <p class="card-value">8</p>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">å®Œæˆç‡</h3>
                        <span>âœ…</span>
                    </div>
                    <p class="card-value">68%</p>
                </div>
            </div>
            
            <div class="table-container">
                <h3>é¡¹ç›®è¿›åº¦</h3>
                <table>
                    <thead>
                        <tr>
                            <th>é¡¹ç›®åç§°</th>
                            <th>è´Ÿè´£äºº</th>
                            <th>æˆªæ­¢æ—¥æœŸ</th>
                            <th>çŠ¶æ€</th>
                            <th>å®Œæˆåº¦</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>ç½‘ç«™é‡æ„</td>
                            <td>å¼ ä¸‰</td>
                            <td>2023-12-15</td>
                            <td><span class="status status-in-progress">è¿›è¡Œä¸­</span></td>
                            <td>65%</td>
                        </tr>
                        <tr>
                            <td>ç§»åŠ¨åº”ç”¨å¼€å‘</td>
                            <td>æå››</td>
                            <td>2023-11-30</td>
                            <td><span class="status status-delayed">å»¶æœŸ</span></td>
                            <td>40%</td>
                        </tr>
                        <tr>
                            <td>æ•°æ®åˆ†æå¹³å°</td>
                            <td>ç‹äº”</td>
                            <td>2023-12-20</td>
                            <td><span class="status status-in-progress">è¿›è¡Œä¸­</span></td>
                            <td>30%</td>
                        </tr>
                        <tr>
                            <td>ç”¨æˆ·è°ƒç ”</td>
                            <td>èµµå…­</td>
                            <td>2023-11-10</td>
                            <td><span class="status status-completed">å·²å®Œæˆ</span></td>
                            <td>100%</td>
                        </tr>
                        <tr>
                            <td>å¸‚åœºæ¨å¹¿</td>
                            <td>é’±ä¸ƒ</td>
                            <td>2023-12-25</td>
                            <td><span class="status status-pending">æœªå¼€å§‹</span></td>
                            <td>0%</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <!-- é¡¹ç›®å†…å®¹åŒºåŸŸ -->
            <div id="projects-content" style="display: none;">
                <h2>é¡¹ç›®ç®¡ç†</h2>
                <div class="projects-grid">
                    <div class="project-card">
                        <div class="project-header">
                            <h3>ç½‘ç«™é‡æ„</h3>
                            <span class="project-status status-in-progress">è¿›è¡Œä¸­</span>
                        </div>
                        <div class="project-info">
                            <p><strong>è´Ÿè´£äºº:</strong> å¼ ä¸‰</p>
                            <p><strong>æˆªæ­¢æ—¥æœŸ:</strong> 2023-12-15</p>
                            <p><strong>å®Œæˆåº¦:</strong> 65%</p>
                        </div>
                        <div class="project-progress">
                            <div class="progress-bar">
                                <div class="progress" style="width: 65%;"></div>
                            </div>
                        </div>
                        <div class="project-actions">
                            <button class="btn-view">æŸ¥çœ‹è¯¦æƒ…</button>
                            <button class="btn-edit">ç¼–è¾‘</button>
                        </div>
                    </div>
                    
                    <div class="project-card">
                        <div class="project-header">
                            <h3>ç§»åŠ¨åº”ç”¨å¼€å‘</h3>
                            <span class="project-status status-delayed">å»¶æœŸ</span>
                        </div>
                        <div class="project-info">
                            <p><strong>è´Ÿè´£äºº:</strong> æå››</p>
                            <p><strong>æˆªæ­¢æ—¥æœŸ:</strong> 2023-11-30</p>
                            <p><strong>å®Œæˆåº¦:</strong> 40%</p>
                        </div>
                        <div class="project-progress">
                            <div class="progress-bar">
                                <div class="progress" style="width: 40%;"></div>
                            </div>
                        </div>
                        <div class="project-actions">
                            <button class="btn-view">æŸ¥çœ‹è¯¦æƒ…</button>
                            <button class="btn-edit">ç¼–è¾‘</button>
                        </div>
                    </div>
                    
                    <div class="project-card">
                        <div class="project-header">
                            <h3>æ•°æ®åˆ†æå¹³å°</h3>
                            <span class="project-status status-in-progress">è¿›è¡Œä¸­</span>
                        </div>
                        <div class="project-info">
                            <p><strong>è´Ÿè´£äºº:</strong> ç‹äº”</p>
                            <p><strong>æˆªæ­¢æ—¥æœŸ:</strong> 2023-12-20</p>
                            <p><strong>å®Œæˆåº¦:</strong> 30%</p>
                        </div>
                        <div class="project-progress">
                            <div class="progress-bar">
                                <div class="progress" style="width: 30%;"></div>
                            </div>
                        </div>
                        <div class="project-actions">
                            <button class="btn-view">æŸ¥çœ‹è¯¦æƒ…</button>
                            <button class="btn-edit">ç¼–è¾‘</button>
                        </div>
                    </div>
                </div>
                <button class="btn-add-project">+ æ·»åŠ æ–°é¡¹ç›®</button>
            </div>
            
            <!-- ä»»åŠ¡å†…å®¹åŒºåŸŸ -->
            <div id="tasks-content" style="display: none;">
                <h2>ä»»åŠ¡ç®¡ç†</h2>
                <div class="tasks-filter">
                    <select id="task-filter">
                        <option value="all">æ‰€æœ‰ä»»åŠ¡</option>
                        <option value="pending">å¾…å¤„ç†</option>
                        <option value="in-progress">è¿›è¡Œä¸­</option>
                        <option value="completed">å·²å®Œæˆ</option>
                    </select>
                    <input type="text" placeholder="æœç´¢ä»»åŠ¡..." id="task-search">
                </div>
                <div class="tasks-list">
                    <div class="task-item">
                        <input type="checkbox" id="task1">
                        <label for="task1">å®Œæˆé¦–é¡µè®¾è®¡ç¨¿</label>
                        <span class="task-due">ä»Šå¤©</span>
                        <span class="task-priority high">é«˜</span>
                    </div>
                    <div class="task-item">
                        <input type="checkbox" id="task2">
                        <label for="task2">ä¿®å¤ç™»å½•é¡µé¢çš„Bug</label>
                        <span class="task-due">æ˜å¤©</span>
                        <span class="task-priority medium">ä¸­</span>
                    </div>
                    <div class="task-item">
                        <input type="checkbox" id="task3" checked>
                        <label for="task3" class="completed">å‡†å¤‡é¡¹ç›®è¿›åº¦æŠ¥å‘Š</label>
                        <span class="task-due">å·²å®Œæˆ</span>
                        <span class="task-priority low">ä½</span>
                    </div>
                    <div class="task-item">
                        <input type="checkbox" id="task4">
                        <label for="task4">ä¸å®¢æˆ·ä¼šè®®</label>
                        <span class="task-due">2023-11-25</span>
                        <span class="task-priority high">é«˜</span>
                    </div>
                    <div class="task-item">
                        <input type="checkbox" id="task5">
                        <label for="task5">æ›´æ–°APIæ–‡æ¡£</label>
                        <span class="task-due">2023-11-28</span>
                        <span class="task-priority medium">ä¸­</span>
                    </div>
                </div>
                <div class="add-task">
                    <input type="text" placeholder="æ·»åŠ æ–°ä»»åŠ¡..." id="new-task">
                    <button id="add-task-btn">æ·»åŠ </button>
                </div>
            </div>
            
            <!-- å›¢é˜Ÿå†…å®¹åŒºåŸŸ -->
            <div id="team-content" style="display: none;">
                <h2>å›¢é˜Ÿæˆå‘˜</h2>
                <div class="team-grid">
                    <div class="team-card">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSIxMDAiIGN5PSIxMDAiIHI9IjEwMCIgZmlsbD0iIzJjM2U1MCIvPjxjaXJjbGUgY3g9IjEwMCIgY3k9IjgwIiByPSI0MCIgZmlsbD0iI2VjZjBmMSIvPjxwYXRoIGQ9Ik0xNjAgMTgwYzAtMzMuMTM3LTI2Ljg2My02MC02MC02MHMtNjAgMjYuODYzLTYwIDYwIiBmaWxsPSIjZWNmMGYxIi8+PC9zdmc+" alt="å¼ ä¸‰">
                        <h3>å¼ ä¸‰</h3>
                        <p class="team-role">å‰ç«¯å¼€å‘</p>
                        <p class="team-contact">zhangsan@example.com</p>
                        <div class="team-projects">è´Ÿè´£é¡¹ç›®: 3</div>
                    </div>
                    
                    <div class="team-card">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSIxMDAiIGN5PSIxMDAiIHI9IjEwMCIgZmlsbD0iIzI3YWU2MCIvPjxjaXJjbGUgY3g9IjEwMCIgY3k9IjgwIiByPSI0MCIgZmlsbD0iI2VjZjBmMSIvPjxwYXRoIGQ9Ik0xNjAgMTgwYzAtMzMuMTM3LTI2Ljg2My02MC02MC02MHMtNjAgMjYuODYzLTYwIDYwIiBmaWxsPSIjZWNmMGYxIi8+PC9zdmc+" alt="æå››">
                        <h3>æå››</h3>
                        <p class="team-role">åç«¯å¼€å‘</p>
                        <p class="team-contact">lisi@example.com</p>
                        <div class="team-projects">è´Ÿè´£é¡¹ç›®: 2</div>
                    </div>
                    
                    <div class="team-card">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSIxMDAiIGN5PSIxMDAiIHI9IjEwMCIgZmlsbD0iIzk5ODBmYSIvPjxjaXJjbGUgY3g9IjEwMCIgY3k9IjgwIiByPSI0MCIgZmlsbD0iI2VjZjBmMSIvPjxwYXRoIGQ9Ik0xNjAgMTgwYzAtMzMuMTM3LTI2Ljg2My02MC02MC02MHMtNjAgMjYuODYzLTYwIDYwIiBmaWxsPSIjZWNmMGYxIi8+PC9zdmc+" alt="ç‹äº”">
                        <h3>ç‹äº”</h3>
                        <p class="team-role">æ•°æ®åˆ†æå¸ˆ</p>
                        <p class="team-contact">wangwu@example.com</p>
                        <div class="team-projects">è´Ÿè´£é¡¹ç›®: 1</div>
                    </div>
                    
                    <div class="team-card">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSIxMDAiIGN5PSIxMDAiIHI9IjEwMCIgZmlsbD0iI2UxN2I3NyIvPjxjaXJjbGUgY3g9IjEwMCIgY3k9IjgwIiByPSI0MCIgZmlsbD0iI2VjZjBmMSIvPjxwYXRoIGQ9Ik0xNjAgMTgwYzAtMzMuMTM3LTI2Ljg2My02MC02MC02MHMtNjAgMjYuODYzLTYwIDYwIiBmaWxsPSIjZWNmMGYxIi8+PC9zdmc+" alt="èµµå…­">
                        <h3>èµµå…­</h3>
                        <p class="team-role">UIè®¾è®¡å¸ˆ</p>
                        <p class="team-contact">zhaoliu@example.com</p>
                        <div class="team-projects">è´Ÿè´£é¡¹ç›®: 2</div>
                    </div>
                    
                    <div class="team-card add-member">
                        <div class="add-icon">+</div>
                        <p>æ·»åŠ æ–°æˆå‘˜</p>
                    </div>
                </div>
            </div>
            
            <!-- æŠ¥è¡¨å†…å®¹åŒºåŸŸ -->
            <div id="reports-content" style="display: none;">
                <h2>æ•°æ®æŠ¥è¡¨</h2>
                <div class="reports-filters">
                    <div class="date-range">
                        <label>æ—¥æœŸèŒƒå›´:</label>
                        <select>
                            <option>æœ¬å‘¨</option>
                            <option>æœ¬æœˆ</option>
                            <option>æœ¬å­£åº¦</option>
                            <option>æœ¬å¹´</option>
                            <option>è‡ªå®šä¹‰</option>
                        </select>
                    </div>
                    <div class="report-type">
                        <label>æŠ¥è¡¨ç±»å‹:</label>
                        <select>
                            <option>é¡¹ç›®è¿›åº¦</option>
                            <option>ä»»åŠ¡å®Œæˆç‡</option>
                            <option>å›¢é˜Ÿå·¥ä½œé‡</option>
                            <option>èµ„æºåˆ†é…</option>
                        </select>
                    </div>
                    <button class="btn-generate">ç”ŸæˆæŠ¥è¡¨</button>
                </div>
                
                <div class="reports-charts">
                    <div class="chart-container">
                        <h3>é¡¹ç›®è¿›åº¦æ¦‚è§ˆ</h3>
                        <div class="chart-placeholder">
                            <div class="bar-chart">
                                <div class="bar" style="height: 65%;"><span>ç½‘ç«™é‡æ„</span></div>
                                <div class="bar" style="height: 40%;"><span>ç§»åŠ¨åº”ç”¨</span></div>
                                <div class="bar" style="height: 30%;"><span>æ•°æ®å¹³å°</span></div>
                                <div class="bar" style="height: 100%;"><span>ç”¨æˆ·è°ƒç ”</span></div>
                                <div class="bar" style="height: 10%;"><span>å¸‚åœºæ¨å¹¿</span></div>
                            </div>
                            <div class="chart-axis">å®Œæˆç™¾åˆ†æ¯”</div>
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <h3>ä»»åŠ¡çŠ¶æ€åˆ†å¸ƒ</h3>
                        <div class="chart-placeholder">
                            <div class="pie-chart">
                                <div class="pie-segment" style="--percentage: 25%; --color: #4CAF50;">å·²å®Œæˆ</div>
                                <div class="pie-segment" style="--percentage: 45%; --color: #2196F3;">è¿›è¡Œä¸­</div>
                                <div class="pie-segment" style="--percentage: 15%; --color: #FFC107;">å»¶æœŸ</div>
                                <div class="pie-segment" style="--percentage: 15%; --color: #9E9E9E;">æœªå¼€å§‹</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="reports-summary">
                    <h3>æŠ¥è¡¨æ‘˜è¦</h3>
                    <ul>
                        <li>é¡¹ç›®æ€»æ•°: <strong>5</strong></li>
                        <li>å·²å®Œæˆé¡¹ç›®: <strong>1</strong> (20%)</li>
                        <li>ä»»åŠ¡æ€»æ•°: <strong>24</strong></li>
                        <li>å·²å®Œæˆä»»åŠ¡: <strong>8</strong> (33%)</li>
                        <li>å¹³å‡é¡¹ç›®å®Œæˆç‡: <strong>47%</strong></li>
                    </ul>
                </div>
                
                <button class="btn-export">å¯¼å‡ºæŠ¥è¡¨</button>
            </div>
            
            <!-- è®¾ç½®å†…å®¹åŒºåŸŸ -->
            <div id="settings-content" style="display: none;">
                <h2>ç³»ç»Ÿè®¾ç½®</h2>
                
                <div class="settings-section">
                    <h3>ä¸ªäººä¿¡æ¯</h3>
                    <div class="settings-form">
                        <div class="form-group">
                            <label>ç”¨æˆ·å</label>
                            <input type="text" value="ç”¨æˆ·å">
                        </div>
                        <div class="form-group">
                            <label>é‚®ç®±</label>
                            <input type="email" value="user@example.com">
                        </div>
                        <div class="form-group">
                            <label>å¯†ç </label>
                            <input type="password" value="********">
                        </div>
                        <button class="btn-save">ä¿å­˜æ›´æ”¹</button>
                    </div>
                </div>
                
                <div class="settings-section">
                    <h3>é€šçŸ¥è®¾ç½®</h3>
                    <div class="settings-options">
                        <div class="option-item">
                            <label>
                                <input type="checkbox" checked>
                                ä»»åŠ¡æé†’
                            </label>
                        </div>
                        <div class="option-item">
                            <label>
                                <input type="checkbox" checked>
                                é¡¹ç›®æ›´æ–°
                            </label>
                        </div>
                        <div class="option-item">
                            <label>
                                <input type="checkbox">
                                ç³»ç»Ÿå…¬å‘Š
                            </label>
                        </div>
                        <div class="option-item">
                            <label>
                                <input type="checkbox" checked>
                                å›¢é˜Ÿæ¶ˆæ¯
                            </label>
                        </div>
                    </div>
                </div>
                
                <div class="settings-section">
                    <h3>ä¸»é¢˜è®¾ç½®</h3>
                    <div class="theme-options">
                        <div class="theme-option active">
                            <div class="theme-preview light"></div>
                            <span>æµ…è‰²</span>
                        </div>
                        <div class="theme-option">
                            <div class="theme-preview dark"></div>
                            <span>æ·±è‰²</span>
                        </div>
                        <div class="theme-option">
                            <div class="theme-preview blue"></div>
                            <span>è“è‰²</span>
                        </div>
                    </div>
                </div>
                
                <div class="settings-section">
                    <h3>è¯­è¨€è®¾ç½®</h3>
                    <select class="language-select">
                        <option selected>ç®€ä½“ä¸­æ–‡</option>
                        <option>English</option>
                        <option>æ—¥æœ¬èª</option>
                        <option>í•œêµ­ì–´</option>
                    </select>
                </div>
            </div>
        </div>
    </div>
    
    <!-- æ¸¸æˆå®¹å™¨ -->
    <div class="game-container" id="game-container">
        <div class="game-header">
            <h3 id="game-title">ä¼‘æ¯ä¸€ä¸‹</h3>
            <button class="close-game" onclick="toggleGame()">Ã—</button>
        </div>
        <div class="game-content" id="game-content">
            <!-- 2048æ¸¸æˆ -->
            <div class="game-2048" id="game-2048" style="display: none;">
                <div class="game-header-2048">
                    <div class="score-container">
                        <div>åˆ†æ•°</div>
                        <div id="score">0</div>
                    </div>
                    <button onclick="resetGame2048()">é‡æ–°å¼€å§‹</button>
                </div>
                <div class="grid-container" id="grid-container">
                    <!-- 4x4ç½‘æ ¼å°†ç”±JavaScriptç”Ÿæˆ -->
                </div>
            </div>
            
            <!-- è´ªåƒè›‡æ¸¸æˆ -->
            <div class="game-snake" id="game-snake" style="display: none;">
                <div class="snake-board" id="snake-board"></div>
                <div class="snake-controls">
                <button onclick="startSnakeGame()">å¼€å§‹æ¸¸æˆ</button>
                <button onclick="pauseSnakeGame()">æš‚åœ</button>
            </div>
            <div class="snake-instructions">
                <p>ä½¿ç”¨é”®ç›˜æ–¹å‘é”®æ§åˆ¶è›‡çš„ç§»åŠ¨</p>
                <div class="touch-controls">
                    <button id="up-btn">â†‘</button>
                    <div class="touch-controls-middle">
                        <button id="left-btn">â†</button>
                        <button id="right-btn">â†’</button>
                    </div>
                    <button id="down-btn">â†“</button>
                </div>
            </div>
            </div>
        </div>
    </div>
    
    <!-- ç´§æ€¥å…³é—­æŒ‰é’® -->
    <button class="emergency-close" id="emergency-close" onclick="emergencyClose()">ç´§æ€¥å…³é—­</button>
    
    <!-- è¦†ç›–å±‚ -->
    <div class="overlay" id="overlay"></div>
    
    <script>
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–åŠŸèƒ½
        document.addEventListener('DOMContentLoaded', function() {
            // åˆå§‹åŒ–ä»ªè¡¨ç›˜
            showDashboard();
            
            // åˆå§‹åŒ–ä»»åŠ¡å¤é€‰æ¡†äº‹ä»¶
            initTaskCheckboxes();
            
            // åˆå§‹åŒ–æ·»åŠ ä»»åŠ¡åŠŸèƒ½
            initAddTaskFeature();
            
            // åˆå§‹åŒ–é¡¹ç›®å¡ç‰‡äº¤äº’
            initProjectCards();
            
            // åˆå§‹åŒ–ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½
            initThemeToggle();
            
            // åˆå§‹åŒ–æŠ¥è¡¨ç”ŸæˆåŠŸèƒ½
            initReportGeneration();
            
            // åˆå§‹åŒ–å¾…å¤„ç†ä»»åŠ¡æ•°é‡
            updatePendingTasksCount();
        });
        
        // æ˜¾ç¤ºä¸åŒçš„å†…å®¹åŒºåŸŸ
        function showDashboard(navText) {
            // éšè—æ‰€æœ‰å†…å®¹åŒºåŸŸ
            hideAllContentAreas();
            
            // ç§»é™¤æ‰€æœ‰å¯¼èˆªé¡¹çš„activeç±»
            const menuItems = document.querySelectorAll('.sidebar-menu li');
            menuItems.forEach(item => item.classList.remove('active'));
            
            // æ ¹æ®ä¼ å…¥çš„å¯¼èˆªé¡¹æ–‡æœ¬æ˜¾ç¤ºå¯¹åº”çš„å†…å®¹
            // å¦‚æœæ²¡æœ‰ä¼ å…¥å¯¼èˆªé¡¹æ–‡æœ¬ï¼Œåˆ™é»˜è®¤æ˜¾ç¤ºä»ªè¡¨ç›˜
            if (!navText) {
                document.querySelector('.dashboard').style.display = 'grid';
                document.querySelector('.table-container').style.display = 'block';
                // é»˜è®¤é€‰ä¸­ä»ªè¡¨ç›˜èœå•é¡¹
                menuItems[0].classList.add('active');
                return;
            }
            
            // æ ¹æ®ç‚¹å‡»çš„å¯¼èˆªé¡¹æ˜¾ç¤ºå¯¹åº”çš„å†…å®¹
            switch(navText) {
                case 'ğŸ“Š ä»ªè¡¨ç›˜':
                    document.querySelector('.dashboard').style.display = 'grid';
                    document.querySelector('.table-container').style.display = 'block';
                    menuItems[0].classList.add('active');
                    break;
                case 'ğŸ“‹ é¡¹ç›®':
                    document.getElementById('projects-content').style.display = 'block';
                    menuItems[1].classList.add('active');
                    break;
                case 'âœ… ä»»åŠ¡':
                    document.getElementById('tasks-content').style.display = 'block';
                    menuItems[2].classList.add('active');
                    break;
                case 'ğŸ‘¥ å›¢é˜Ÿ':
                    document.getElementById('team-content').style.display = 'block';
                    menuItems[3].classList.add('active');
                    break;
                case 'ğŸ“ˆ æŠ¥è¡¨':
                    document.getElementById('reports-content').style.display = 'block';
                    menuItems[4].classList.add('active');
                    break;
                case 'âš™ï¸ è®¾ç½®':
                    document.getElementById('settings-content').style.display = 'block';
                    menuItems[5].classList.add('active');
                    break;
                default:
                    // é»˜è®¤æ˜¾ç¤ºä»ªè¡¨ç›˜
                    document.querySelector('.dashboard').style.display = 'grid';
                    document.querySelector('.table-container').style.display = 'block';
                    menuItems[0].classList.add('active');
                    break;
            }
        }
        
        // éšè—æ‰€æœ‰å†…å®¹åŒºåŸŸ
        function hideAllContentAreas() {
            document.querySelector('.dashboard').style.display = 'none';
            document.querySelector('.table-container').style.display = 'none';
            document.getElementById('projects-content').style.display = 'none';
            document.getElementById('tasks-content').style.display = 'none';
            document.getElementById('team-content').style.display = 'none';
            document.getElementById('reports-content').style.display = 'none';
            document.getElementById('settings-content').style.display = 'none';
        }
        
        // åˆå§‹åŒ–ä»»åŠ¡å¤é€‰æ¡†äº‹ä»¶
        function initTaskCheckboxes() {
            const checkboxes = document.querySelectorAll('.task-item input[type="checkbox"]');
            checkboxes.forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    const label = this.nextElementSibling;
                    if (this.checked) {
                        label.classList.add('completed');
                        const dueDate = label.nextElementSibling;
                        dueDate.textContent = 'å·²å®Œæˆ';
                    } else {
                        label.classList.remove('completed');
                        // æ¢å¤åŸæ¥çš„æ—¥æœŸï¼ˆè¿™é‡Œç®€åŒ–å¤„ç†ï¼‰
                        const dueDate = label.nextElementSibling;
                        if (dueDate.textContent === 'å·²å®Œæˆ') {
                            dueDate.textContent = 'å¾…å®š';
                        }
                    }
                    
                    // æ›´æ–°ä»ªè¡¨ç›˜ä¸Šçš„å¾…å¤„ç†ä»»åŠ¡æ•°é‡
                    updatePendingTasksCount();
                });
            });
        }
        
        // æ›´æ–°å¾…å¤„ç†ä»»åŠ¡æ•°é‡
        function updatePendingTasksCount() {
            const totalTasks = document.querySelectorAll('.task-item').length;
            const completedTasks = document.querySelectorAll('.task-item input[type="checkbox"]:checked').length;
            const pendingTasks = totalTasks - completedTasks;
            
            // æ›´æ–°ä»ªè¡¨ç›˜ä¸Šçš„æ•°å­—
            const pendingTasksCard = document.querySelector('.card:nth-child(2) .card-value');
            if (pendingTasksCard) {
                pendingTasksCard.textContent = pendingTasks;
            }
        }
        
        // åˆå§‹åŒ–æ·»åŠ ä»»åŠ¡åŠŸèƒ½
        function initAddTaskFeature() {
            const addTaskBtn = document.getElementById('add-task-btn');
            const newTaskInput = document.getElementById('new-task');
            
            if (addTaskBtn && newTaskInput) {
                addTaskBtn.addEventListener('click', function() {
                    const taskText = newTaskInput.value.trim();
                    if (taskText) {
                        addNewTask(taskText);
                        newTaskInput.value = '';
                    }
                });
                
                newTaskInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        const taskText = newTaskInput.value.trim();
                        if (taskText) {
                            addNewTask(taskText);
                            newTaskInput.value = '';
                        }
                    }
                });
            }
        }
        
        // æ·»åŠ æ–°ä»»åŠ¡
        function addNewTask(taskText) {
            const tasksList = document.querySelector('.tasks-list');
            const taskId = 'task' + (document.querySelectorAll('.task-item').length + 1);
            
            const taskItem = document.createElement('div');
            taskItem.className = 'task-item';
            
            taskItem.innerHTML = `
                <input type="checkbox" id="${taskId}">
                <label for="${taskId}">${taskText}</label>
                <span class="task-due">ä»Šå¤©</span>
                <span class="task-priority medium">ä¸­</span>
            `;
            
            tasksList.appendChild(taskItem);
            
            // ä¸ºæ–°æ·»åŠ çš„å¤é€‰æ¡†æ·»åŠ äº‹ä»¶ç›‘å¬
            const checkbox = taskItem.querySelector('input[type="checkbox"]');
            checkbox.addEventListener('change', function() {
                const label = this.nextElementSibling;
                if (this.checked) {
                    label.classList.add('completed');
                    const dueDate = label.nextElementSibling;
                    dueDate.textContent = 'å·²å®Œæˆ';
                } else {
                    label.classList.remove('completed');
                    const dueDate = label.nextElementSibling;
                    dueDate.textContent = 'ä»Šå¤©';
                }
                
                // æ›´æ–°ä»ªè¡¨ç›˜ä¸Šçš„å¾…å¤„ç†ä»»åŠ¡æ•°é‡
                updatePendingTasksCount();
            });
            
            // æ›´æ–°ä»ªè¡¨ç›˜ä¸Šçš„å¾…å¤„ç†ä»»åŠ¡æ•°é‡
            updatePendingTasksCount();
        }
        
        // åˆå§‹åŒ–é¡¹ç›®å¡ç‰‡äº¤äº’
        function initProjectCards() {
            // æ·»åŠ é¡¹ç›®æŒ‰é’®ç‚¹å‡»äº‹ä»¶
            const addProjectBtn = document.querySelector('.btn-add-project');
            if (addProjectBtn) {
                addProjectBtn.addEventListener('click', function() {
                    alert('æ‰“å¼€æ·»åŠ é¡¹ç›®è¡¨å•ï¼ˆæ­¤åŠŸèƒ½å°šæœªå®ç°ï¼‰');
                });
            }
            
            // é¡¹ç›®å¡ç‰‡æŒ‰é’®ç‚¹å‡»äº‹ä»¶
            const viewButtons = document.querySelectorAll('.btn-view');
            const editButtons = document.querySelectorAll('.btn-edit');
            
            viewButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const projectName = this.closest('.project-card').querySelector('h3').textContent;
                    alert(`æŸ¥çœ‹é¡¹ç›®è¯¦æƒ…ï¼š${projectName}ï¼ˆæ­¤åŠŸèƒ½å°šæœªå®ç°ï¼‰`);
                });
            });
            
            editButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const projectName = this.closest('.project-card').querySelector('h3').textContent;
                    alert(`ç¼–è¾‘é¡¹ç›®ï¼š${projectName}ï¼ˆæ­¤åŠŸèƒ½å°šæœªå®ç°ï¼‰`);
                });
            });
        }
        
        // åˆå§‹åŒ–ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½
        function initThemeToggle() {
            const themeOptions = document.querySelectorAll('.theme-option');
            
            themeOptions.forEach(option => {
                option.addEventListener('click', function() {
                    // ç§»é™¤æ‰€æœ‰ä¸»é¢˜é€‰é¡¹çš„æ´»åŠ¨çŠ¶æ€
                    themeOptions.forEach(opt => opt.classList.remove('active'));
                    
                    // æ·»åŠ å½“å‰é€‰é¡¹çš„æ´»åŠ¨çŠ¶æ€
                    this.classList.add('active');
                    
                    // è·å–é€‰æ‹©çš„ä¸»é¢˜
                    const theme = this.querySelector('.theme-preview').classList[1];
                    
                    // åº”ç”¨ä¸»é¢˜ï¼ˆç®€åŒ–å®ç°ï¼Œå®é™…åº”ç”¨ä¸­å¯èƒ½éœ€è¦æ›´å¤æ‚çš„é€»è¾‘ï¼‰
                    document.body.className = ''; // æ¸…é™¤ä¹‹å‰çš„ä¸»é¢˜
                    document.body.classList.add(`theme-${theme}`);
                    
                    // æ˜¾ç¤ºæç¤ºæ¶ˆæ¯
                    showNotification(`å·²åˆ‡æ¢åˆ°${this.querySelector('span').textContent}ä¸»é¢˜`);
                });
            });
        }
        
        // åˆå§‹åŒ–æŠ¥è¡¨ç”ŸæˆåŠŸèƒ½
        function initReportGeneration() {
            const generateBtn = document.querySelector('.btn-generate');
            const exportBtn = document.querySelector('.btn-export');
            
            if (generateBtn) {
                generateBtn.addEventListener('click', function() {
                    // æ¨¡æ‹ŸæŠ¥è¡¨ç”Ÿæˆè¿‡ç¨‹
                    this.textContent = 'ç”Ÿæˆä¸­...';
                    this.disabled = true;
                    
                    setTimeout(() => {
                        this.textContent = 'ç”ŸæˆæŠ¥è¡¨';
                        this.disabled = false;
                        
                        // éšæœºæ›´æ–°å›¾è¡¨æ•°æ®ï¼ˆç®€åŒ–å®ç°ï¼‰
                        updateChartData();
                        
                        showNotification('æŠ¥è¡¨å·²ç”Ÿæˆ');
                    }, 1500);
                });
            }
            
            if (exportBtn) {
                exportBtn.addEventListener('click', function() {
                    showNotification('æŠ¥è¡¨å·²å¯¼å‡ºåˆ°æ‚¨çš„ä¸‹è½½æ–‡ä»¶å¤¹');
                });
            }
        }
        
        // æ›´æ–°å›¾è¡¨æ•°æ®
        function updateChartData() {
            // æ›´æ–°æŸ±çŠ¶å›¾
            const bars = document.querySelectorAll('.bar');
            bars.forEach(bar => {
                const randomHeight = Math.floor(Math.random() * 80) + 20; // 20% - 100%
                bar.style.height = `${randomHeight}%`;
            });
            
            // æ›´æ–°æŠ¥è¡¨æ‘˜è¦
            const summaryItems = document.querySelectorAll('.reports-summary li strong');
            summaryItems.forEach(item => {
                if (item.textContent.includes('%')) {
                    const randomPercent = Math.floor(Math.random() * 100);
                    item.textContent = `${randomPercent}%`;
                }
            });
        }
        
        // æ˜¾ç¤ºé€šçŸ¥æ¶ˆæ¯
        function showNotification(message) {
            // æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨é€šçŸ¥å…ƒç´ 
            let notification = document.querySelector('.notification');
            
            if (!notification) {
                // åˆ›å»ºé€šçŸ¥å…ƒç´ 
                notification = document.createElement('div');
                notification.className = 'notification';
                document.body.appendChild(notification);
                
                // æ·»åŠ æ ·å¼
                const style = document.createElement('style');
                style.textContent = `
                    .notification {
                        position: fixed;
                        top: 20px;
                        right: 20px;
                        background-color: #2ecc71;
                        color: white;
                        padding: 12px 20px;
                        border-radius: 4px;
                        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
                        z-index: 1000;
                        opacity: 0;
                        transform: translateY(-20px);
                        transition: opacity 0.3s, transform 0.3s;
                    }
                    .notification.show {
                        opacity: 1;
                        transform: translateY(0);
                    }
                `;
                document.head.appendChild(style);
            }
            
            // è®¾ç½®æ¶ˆæ¯å†…å®¹
            notification.textContent = message;
            
            // æ˜¾ç¤ºé€šçŸ¥
            notification.classList.add('show');
            
            // 3ç§’åéšè—é€šçŸ¥
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // åˆ‡æ¢æ¸¸æˆæ˜¾ç¤º
        function toggleGame(gameType) {
            const gameContainer = document.getElementById('game-container');
            const overlay = document.getElementById('overlay');
            const emergencyClose = document.getElementById('emergency-close');
            const game2048 = document.getElementById('game-2048');
            const gameSnake = document.getElementById('game-snake');
            const gameTitle = document.getElementById('game-title');
            
            if (gameType) {
                gameContainer.style.display = 'block';
                overlay.style.display = 'block';
                emergencyClose.style.display = 'block';
                
                // éšè—æ‰€æœ‰æ¸¸æˆ
                game2048.style.display = 'none';
                gameSnake.style.display = 'none';
                
                // æ˜¾ç¤ºé€‰æ‹©çš„æ¸¸æˆ
                if (gameType === '2048') {
                    game2048.style.display = 'block';
                    gameTitle.textContent = '2048æ¸¸æˆ';
                    if (!gameInitialized2048) {
                        initGame2048();
                    }
                } else if (gameType === 'snake') {
                    gameSnake.style.display = 'block';
                    gameTitle.textContent = 'è´ªåƒè›‡æ¸¸æˆ';
                    if (!gameInitializedSnake) {
                        initSnakeGame();
                    }
                }
            } else {
                gameContainer.style.display = 'none';
                overlay.style.display = 'none';
                emergencyClose.style.display = 'none';
            }
        }
        
        // ç´§æ€¥å…³é—­
        function emergencyClose() {
            toggleGame();
        }
        
        // é”®ç›˜å¿«æ·é”®
        document.addEventListener('keydown', function(event) {
            // ESCé”®å…³é—­æ¸¸æˆ
            if (event.key === 'Escape') {
                toggleGame();
            }
            
            // 2048æ¸¸æˆæ§åˆ¶
            if (document.getElementById('game-2048').style.display === 'block') {
                if (event.key === 'ArrowUp' || event.key === 'ArrowDown' || 
                    event.key === 'ArrowLeft' || event.key === 'ArrowRight') {
                    event.preventDefault();
                    moveGame2048(event.key);
                }
            }
            
            // è´ªåƒè›‡æ¸¸æˆæ§åˆ¶
            if (document.getElementById('game-snake').style.display === 'block' && snakeGameRunning) {
                if (event.key === 'ArrowUp' || event.key === 'ArrowDown' || 
                    event.key === 'ArrowLeft' || event.key === 'ArrowRight') {
                    event.preventDefault();
                    changeSnakeDirection(event.key);
                }
            }
        });
        
        // åŒå‡»å¿«é€Ÿå…³é—­
        document.addEventListener('dblclick', function(event) {
            if (event.target.closest('.game-container') === null) {
                toggleGame();
            }
        });
        
        // ===== 2048æ¸¸æˆé€»è¾‘ =====
        let gameInitialized2048 = false;
        let grid = [];
        let score = 0;
        
        function initGame2048() {
            gameInitialized2048 = true;
            resetGame2048();
        }
        
        function resetGame2048() {
            // é‡ç½®åˆ†æ•°
            score = 0;
            document.getElementById('score').textContent = score;
            
            // åˆ›å»º4x4ç½‘æ ¼
            const gridContainer = document.getElementById('grid-container');
            gridContainer.innerHTML = '';
            grid = [];
            
            for (let i = 0; i < 4; i++) {
                const gridRow = document.createElement('div');
                gridRow.className = 'grid-row';
                gridContainer.appendChild(gridRow);
                
                const rowArray = [];
                for (let j = 0; j < 4; j++) {
                    const gridCell = document.createElement('div');
                    gridCell.className = 'grid-cell';
                    gridRow.appendChild(gridCell);
                    rowArray.push(0);
                }
                grid.push(rowArray);
            }
            
            // æ·»åŠ ä¸¤ä¸ªåˆå§‹æ•°å­—
            addRandomTile();
            addRandomTile();
            updateGridDisplay();
        }
        
        function addRandomTile() {
            // æ‰¾åˆ°æ‰€æœ‰ç©ºæ ¼å­
            const emptyCells = [];
            for (let i = 0; i < 4; i++) {
                for (let j = 0; j < 4; j++) {
                    if (grid[i][j] === 0) {
                        emptyCells.push({row: i, col: j});
                    }
                }
            }
            
            if (emptyCells.length > 0) {
                // éšæœºé€‰æ‹©ä¸€ä¸ªç©ºæ ¼å­
                const randomCell = emptyCells[Math.floor(Math.random() * emptyCells.length)];
                // 90%æ¦‚ç‡ç”Ÿæˆ2ï¼Œ10%æ¦‚ç‡ç”Ÿæˆ4
                grid[randomCell.row][randomCell.col] = Math.random() < 0.9 ? 2 : 4;
            }
        }
        
        function updateGridDisplay() {
            const gridRows = document.querySelectorAll('.grid-row');
            
            for (let i = 0; i < 4; i++) {
                const cells = gridRows[i].querySelectorAll('.grid-cell');
                for (let j = 0; j < 4; j++) {
                    const cell = cells[j];
                    const value = grid[i][j];
                    
                    // æ¸…é™¤ä¹‹å‰çš„ç±»
                    cell.className = 'grid-cell';
                    cell.textContent = '';
                    
                    if (value !== 0) {
                        cell.textContent = value;
                        cell.classList.add(`tile-${value}`);
                    }
                }
            }
        }
        
        function moveGame2048(direction) {
            let moved = false;
            
            // æ ¹æ®æ–¹å‘ç§»åŠ¨å’Œåˆå¹¶æ ¼å­
            if (direction === 'ArrowUp') {
                moved = moveUp();
            } else if (direction === 'ArrowDown') {
                moved = moveDown();
            } else if (direction === 'ArrowLeft') {
                moved = moveLeft();
            } else if (direction === 'ArrowRight') {
                moved = moveRight();
            }
            
            if (moved) {
                addRandomTile();
                updateGridDisplay();
                document.getElementById('score').textContent = score;
                
                // æ£€æŸ¥æ¸¸æˆæ˜¯å¦ç»“æŸ
                if (isGameOver()) {
                    alert('æ¸¸æˆç»“æŸï¼ä½ çš„åˆ†æ•°æ˜¯: ' + score);
                }
            }
        }
        
        function moveLeft() {
            let moved = false;
            
            for (let i = 0; i < 4; i++) {
                // ç§»åŠ¨éé›¶å…ƒç´ åˆ°å·¦ä¾§
                const row = grid[i].filter(val => val !== 0);
                
                // åˆå¹¶ç›¸é‚»ç›¸åŒçš„æ•°å­—
                for (let j = 0; j < row.length - 1; j++) {
                    if (row[j] === row[j + 1]) {
                        row[j] *= 2;
                        score += row[j];
                        row.splice(j + 1, 1);
                        moved = true;
                    }
                }
                
                // å¡«å……é›¶
                while (row.length < 4) {
                    row.push(0);
                }
                
                // æ£€æŸ¥æ˜¯å¦æœ‰ç§»åŠ¨
                for (let j = 0; j < 4; j++) {
                    if (grid[i][j] !== row[j]) {
                        moved = true;
                    }
                }
                
                grid[i] = row;
            }
            
            return moved;
        }
        
        function moveRight() {
            let moved = false;
            
            for (let i = 0; i < 4; i++) {
                // ç§»åŠ¨éé›¶å…ƒç´ åˆ°å³ä¾§
                const row = grid[i].filter(val => val !== 0);
                
                // åˆå¹¶ç›¸é‚»ç›¸åŒçš„æ•°å­—ï¼ˆä»å³å‘å·¦ï¼‰
                for (let j = row.length - 1; j > 0; j--) {
                    if (row[j] === row[j - 1]) {
                        row[j] *= 2;
                        score += row[j];
                        row.splice(j - 1, 1);
                        moved = true;
                        j--; // è°ƒæ•´ç´¢å¼•
                    }
                }
                
                // å¡«å……é›¶
                while (row.length < 4) {
                    row.unshift(0);
                }
                
                // æ£€æŸ¥æ˜¯å¦æœ‰ç§»åŠ¨
                for (let j = 0; j < 4; j++) {
                    if (grid[i][j] !== row[j]) {
                        moved = true;
                    }
                }
                
                grid[i] = row;
            }
            
            return moved;
        }
        
        function moveUp() {
            let moved = false;
            
            for (let j = 0; j < 4; j++) {
                // è·å–åˆ—
                let column = [];
                for (let i = 0; i < 4; i++) {
                    column.push(grid[i][j]);
                }
                
                // ç§»åŠ¨éé›¶å…ƒç´ åˆ°é¡¶éƒ¨
                column = column.filter(val => val !== 0);
                
                // åˆå¹¶ç›¸é‚»ç›¸åŒçš„æ•°å­—
                for (let i = 0; i < column.length - 1; i++) {
                    if (column[i] === column[i + 1]) {
                        column[i] *= 2;
                        score += column[i];
                        column.splice(i + 1, 1);
                        moved = true;
                    }
                }
                
                // å¡«å……é›¶
                while (column.length < 4) {
                    column.push(0);
                }
                
                // æ›´æ–°åˆ—
                for (let i = 0; i < 4; i++) {
                    if (grid[i][j] !== column[i]) {
                        moved = true;
                    }
                    grid[i][j] = column[i];
                }
            }
            
            return moved;
        }
        
        function moveDown() {
            let moved = false;
            
            for (let j = 0; j < 4; j++) {
                // è·å–åˆ—
                let column = [];
                for (let i = 0; i < 4; i++) {
                    column.push(grid[i][j]);
                }
                
                // ç§»åŠ¨éé›¶å…ƒç´ åˆ°åº•éƒ¨
                column = column.filter(val => val !== 0);
                
                // åˆå¹¶ç›¸é‚»ç›¸åŒçš„æ•°å­—ï¼ˆä»ä¸‹å‘ä¸Šï¼‰
                for (let i = column.length - 1; i > 0; i--) {
                    if (column[i] === column[i - 1]) {
                        column[i] *= 2;
                        score += column[i];
                        column.splice(i - 1, 1);
                        moved = true;
                        i--; // è°ƒæ•´ç´¢å¼•
                    }
                }
                
                // å¡«å……é›¶
                while (column.length < 4) {
                    column.unshift(0);
                }
                
                // æ›´æ–°åˆ—
                for (let i = 0; i < 4; i++) {
                    if (grid[i][j] !== column[i]) {
                        moved = true;
                    }
                    grid[i][j] = column[i];
                }
            }
            
            return moved;
        }
        
        function isGameOver() {
            // æ£€æŸ¥æ˜¯å¦æœ‰ç©ºæ ¼å­
            for (let i = 0; i < 4; i++) {
                for (let j = 0; j < 4; j++) {
                    if (grid[i][j] === 0) {
                        return false;
                    }
                }
            }
            
            // æ£€æŸ¥æ˜¯å¦æœ‰å¯ä»¥åˆå¹¶çš„ç›¸é‚»æ ¼å­
            for (let i = 0; i < 4; i++) {
                for (let j = 0; j < 3; j++) {
                    if (grid[i][j] === grid[i][j + 1]) {
                        return false;
                    }
                }
            }
            
            for (let j = 0; j < 4; j++) {
                for (let i = 0; i < 3; i++) {
                    if (grid[i][j] === grid[i + 1][j]) {
                        return false;
                    }
                }
            }
            
            return true;
        }
        
        // ===== è´ªåƒè›‡æ¸¸æˆé€»è¾‘ =====
        let gameInitializedSnake = false;
let snake = [];
let food = {};
let direction = 'right';
let snakeGameRunning = false;
let gameInterval;
let snakeScore = 0;
let snakeHighScore = 0;
let snakeSpeed = 150; // é»˜è®¤é€Ÿåº¦ï¼Œæ•°å€¼è¶Šå°è¶Šå¿«
let snakeDifficulty = 'normal'; // éš¾åº¦çº§åˆ«ï¼šeasy, normal, hard
let snakeFoodValue = 10; // æ¯ä¸ªé£Ÿç‰©çš„åˆ†æ•°
let snakeGrowth = 1; // æ¯æ¬¡åƒé£Ÿç‰©å¢é•¿çš„é•¿åº¦
let specialFood = null; // ç‰¹æ®Šé£Ÿç‰©
let specialFoodTimer = null; // ç‰¹æ®Šé£Ÿç‰©è®¡æ—¶å™¨
const boardSize = 20; // 20x20ç½‘æ ¼
const cellSize = 20; // æ¯ä¸ªæ ¼å­20px

function initSnakeGame() {
    gameInitializedSnake = true;
    const board = document.getElementById('snake-board');
    board.innerHTML = '';
    
    // åˆ›å»ºç½‘æ ¼
    for (let i = 0; i < boardSize; i++) {
        for (let j = 0; j < boardSize; j++) {
            const cell = document.createElement('div');
            cell.style.width = cellSize + 'px';
            cell.style.height = cellSize + 'px';
            cell.style.position = 'absolute';
            cell.style.left = j * cellSize + 'px';
            cell.style.top = i * cellSize + 'px';
            cell.id = `cell-${i}-${j}`;
            board.appendChild(cell);
        }
    }
    
    // åˆ›å»ºåˆ†æ•°æ˜¾ç¤º
    const scoreContainer = document.createElement('div');
    scoreContainer.className = 'snake-score';
    scoreContainer.id = 'snake-score';
    scoreContainer.textContent = 'åˆ†æ•°: 0 | æœ€é«˜åˆ†: 0';
    
    // åˆ›å»ºéš¾åº¦é€‰æ‹©
    const difficultyContainer = document.createElement('div');
    difficultyContainer.className = 'snake-controls';
    difficultyContainer.style.marginBottom = '15px';
    difficultyContainer.innerHTML = `
        <button onclick="setSnakeDifficulty('easy')" id="easy-btn">ç®€å•</button>
        <button onclick="setSnakeDifficulty('normal')" id="normal-btn" style="background-color: #3d8b40;">æ™®é€š</button>
        <button onclick="setSnakeDifficulty('hard')" id="hard-btn">å›°éš¾</button>
    `;
    
    // å°†åˆ†æ•°å’Œéš¾åº¦é€‰æ‹©æ·»åŠ åˆ°æ¸¸æˆå®¹å™¨
    const gameContainer = document.querySelector('.game-snake');
    gameContainer.insertBefore(scoreContainer, board);
    gameContainer.insertBefore(difficultyContainer, scoreContainer);
    
    // æ·»åŠ è§¦æ‘¸æ§åˆ¶äº‹ä»¶ç›‘å¬å™¨
    setupTouchControls();
    
    resetSnakeGame();
}

function setSnakeDifficulty(level) {
    snakeDifficulty = level;
    
    // é‡ç½®æŒ‰é’®æ ·å¼
    document.getElementById('easy-btn').style.backgroundColor = '#4CAF50';
    document.getElementById('normal-btn').style.backgroundColor = '#4CAF50';
    document.getElementById('hard-btn').style.backgroundColor = '#4CAF50';
    
    // è®¾ç½®é€‰ä¸­æŒ‰é’®æ ·å¼
    document.getElementById(`${level}-btn`).style.backgroundColor = '#3d8b40';
    
    // æ ¹æ®éš¾åº¦è®¾ç½®æ¸¸æˆå‚æ•°
    switch(level) {
        case 'easy':
            snakeSpeed = 200;
            snakeFoodValue = 5;
            snakeGrowth = 1;
            break;
        case 'normal':
            snakeSpeed = 150;
            snakeFoodValue = 10;
            snakeGrowth = 1;
            break;
        case 'hard':
            snakeSpeed = 100;
            snakeFoodValue = 15;
            snakeGrowth = 1;
            break;
    }
    
    // å¦‚æœæ¸¸æˆæ­£åœ¨è¿è¡Œï¼Œé‡æ–°è®¾ç½®é€Ÿåº¦
    if (snakeGameRunning) {
        pauseSnakeGame();
        startSnakeGame();
    }
}

function resetSnakeGame() {
    // é‡ç½®åˆ†æ•°
    snakeScore = 0;
    updateSnakeScore();
    
    // åˆå§‹åŒ–è›‡
    snake = [
        {x: 10, y: 10},
        {x: 9, y: 10},
        {x: 8, y: 10}
    ];
    
    // åˆå§‹æ–¹å‘
    direction = 'right';
    
    // æ¸…é™¤ç‰¹æ®Šé£Ÿç‰©
    if (specialFoodTimer) {
        clearTimeout(specialFoodTimer);
        specialFoodTimer = null;
    }
    specialFood = null;
    
    // ç”Ÿæˆé£Ÿç‰©
    generateFood();
    
    // ç»˜åˆ¶åˆå§‹çŠ¶æ€
    clearBoard();
    drawSnake();
    drawFood();
    
    // åœæ­¢ä»»ä½•ç°æœ‰çš„æ¸¸æˆå¾ªç¯
    if (gameInterval) {
        clearInterval(gameInterval);
        gameInterval = null;
    }
    
    snakeGameRunning = false;
}

function clearBoard() {
    // æ¸…é™¤æ‰€æœ‰æ ¼å­çš„æ ·å¼
    const cells = document.querySelectorAll('#snake-board div');
    cells.forEach(cell => {
        cell.style.backgroundColor = '';
        cell.style.borderRadius = '0';
        cell.style.boxShadow = 'none';
        cell.style.transform = 'scale(1)';
        cell.className = '';
    });
}

function startSnakeGame() {
    if (!snakeGameRunning) {
        snakeGameRunning = true;
        // ç¡®ä¿é£Ÿç‰©å¯è§
        drawFood();
        if (specialFood) drawSpecialFood();
        gameInterval = setInterval(moveSnake, snakeSpeed);
    }
}

function pauseSnakeGame() {
    snakeGameRunning = false;
    if (gameInterval) {
        clearInterval(gameInterval);
        gameInterval = null;
    }
}

function updateSnakeScore() {
    const scoreElement = document.getElementById('snake-score');
    if (scoreElement) {
        if (snakeScore > snakeHighScore) {
            snakeHighScore = snakeScore;
        }
        scoreElement.textContent = `åˆ†æ•°: ${snakeScore} | æœ€é«˜åˆ†: ${snakeHighScore}`;
    }
}

function generateFood() {
    // éšæœºç”Ÿæˆé£Ÿç‰©ä½ç½®
    let foodX, foodY;
    let validPosition = false;
    
    while (!validPosition) {
        foodX = Math.floor(Math.random() * boardSize);
        foodY = Math.floor(Math.random() * boardSize);
        
        // ç¡®ä¿é£Ÿç‰©ä¸åœ¨è›‡èº«ä¸Š
        validPosition = true;
        for (let i = 0; i < snake.length; i++) {
            if (snake[i].x === foodX && snake[i].y === foodY) {
                validPosition = false;
                break;
            }
        }
        
        // ç¡®ä¿ä¸ä¸ç‰¹æ®Šé£Ÿç‰©é‡å 
        if (specialFood && foodX === specialFood.x && foodY === specialFood.y) {
            validPosition = false;
        }
    }
    
    food = {x: foodX, y: foodY};
    
    // æœ‰10%çš„å‡ ç‡ç”Ÿæˆç‰¹æ®Šé£Ÿç‰©
    if (!specialFood && Math.random() < 0.1) {
        generateSpecialFood();
    }
}

function generateSpecialFood() {
    // éšæœºç”Ÿæˆç‰¹æ®Šé£Ÿç‰©ä½ç½®
    let foodX, foodY;
    let validPosition = false;
    
    while (!validPosition) {
        foodX = Math.floor(Math.random() * boardSize);
        foodY = Math.floor(Math.random() * boardSize);
        
        // ç¡®ä¿ç‰¹æ®Šé£Ÿç‰©ä¸åœ¨è›‡èº«ä¸Šå’Œæ™®é€šé£Ÿç‰©ä¸Š
        validPosition = true;
        for (let i = 0; i < snake.length; i++) {
            if (snake[i].x === foodX && snake[i].y === foodY) {
                validPosition = false;
                break;
            }
        }
        
        if (food.x === foodX && food.y === foodY) {
            validPosition = false;
        }
    }
    
    specialFood = {x: foodX, y: foodY, value: snakeFoodValue * 3};
    drawSpecialFood();
    
    // ç‰¹æ®Šé£Ÿç‰©5ç§’åæ¶ˆå¤±
    specialFoodTimer = setTimeout(() => {
        specialFood = null;
        clearSpecialFood();
    }, 5000);
}

function clearSpecialFood() {
    if (!specialFood) return;
    
    const cell = document.getElementById(`cell-${specialFood.y}-${specialFood.x}`);
    if (cell) {
        cell.style.backgroundColor = '';
        cell.style.boxShadow = 'none';
        cell.style.animation = 'none';
        cell.className = '';
    }
    specialFood = null;
}

function drawSnake() {
    // ç»˜åˆ¶è›‡
    snake.forEach((segment, index) => {
        const cell = document.getElementById(`cell-${segment.y}-${segment.x}`);
        if (cell) {
            if (index === 0) {
                // è›‡å¤´
                cell.className = 'snake-head';
                cell.style.width = cellSize + 'px';
                cell.style.height = cellSize + 'px';
                cell.style.left = segment.x * cellSize + 'px';
                cell.style.top = segment.y * cellSize + 'px';
                
                // æ ¹æ®æ–¹å‘è®¾ç½®è›‡å¤´çš„æ—‹è½¬
                let rotation = 0;
                switch(direction) {
                    case 'up': rotation = -90; break;
                    case 'down': rotation = 90; break;
                    case 'left': rotation = 180; break;
                    case 'right': rotation = 0; break;
                }
                cell.style.transform = `rotate(${rotation}deg)`;
            } else {
                // è›‡èº«
                cell.className = 'snake-body';
                cell.style.width = cellSize + 'px';
                cell.style.height = cellSize + 'px';
                cell.style.left = segment.x * cellSize + 'px';
                cell.style.top = segment.y * cellSize + 'px';
                
                // è›‡èº«ä½“æ¸å˜æ•ˆæœ
                const greenValue = Math.max(140 - index * 3, 100);
                cell.style.backgroundColor = `rgb(139, ${greenValue}, 74)`;
            }
        }
    });
}

function drawFood() {
    const foodCell = document.getElementById(`cell-${food.y}-${food.x}`);
    if (foodCell) {
        foodCell.className = 'snake-food';
        foodCell.style.width = cellSize + 'px';
        foodCell.style.height = cellSize + 'px';
        foodCell.style.left = food.x * cellSize + 'px';
        foodCell.style.top = food.y * cellSize + 'px';
    } else {
        console.error('æ‰¾ä¸åˆ°é£Ÿç‰©å•å…ƒæ ¼:', `cell-${food.y}-${food.x}`);
        // é‡æ–°å°è¯•ç”Ÿæˆé£Ÿç‰©
        generateFood();
        const retryFoodCell = document.getElementById(`cell-${food.y}-${food.x}`);
        if (retryFoodCell) {
            retryFoodCell.className = 'snake-food';
            retryFoodCell.style.width = cellSize + 'px';
            retryFoodCell.style.height = cellSize + 'px';
            retryFoodCell.style.left = food.x * cellSize + 'px';
            retryFoodCell.style.top = food.y * cellSize + 'px';
        }
    }
}

function drawSpecialFood() {
    if (!specialFood) return;
    
    const foodCell = document.getElementById(`cell-${specialFood.y}-${specialFood.x}`);
    if (foodCell) {
        foodCell.className = 'snake-food';
        foodCell.style.width = cellSize + 'px';
        foodCell.style.height = cellSize + 'px';
        foodCell.style.left = specialFood.x * cellSize + 'px';
        foodCell.style.top = specialFood.y * cellSize + 'px';
        foodCell.style.backgroundColor = '#E91E63'; // ç²‰è‰²ç‰¹æ®Šé£Ÿç‰©
        foodCell.style.boxShadow = '0 0 15px rgba(233, 30, 99, 0.8)';
        foodCell.style.animation = 'pulse 0.5s infinite alternate';
    }
}

function moveSnake() {
    if (!snakeGameRunning) return;
    
    // è®¡ç®—æ–°çš„å¤´éƒ¨ä½ç½®
    const head = {...snake[0]};
    
    switch (direction) {
        case 'up':
            head.y--;
            break;
        case 'down':
            head.y++;
            break;
        case 'left':
            head.x--;
            break;
        case 'right':
            head.x++;
            break;
    }
    
    // æ£€æŸ¥æ˜¯å¦æ’å¢™
    if (head.x < 0 || head.x >= boardSize || head.y < 0 || head.y >= boardSize) {
        gameOver();
        return;
    }
    
    // æ£€æŸ¥æ˜¯å¦æ’åˆ°è‡ªå·±
    for (let i = 0; i < snake.length; i++) {
        if (snake[i].x === head.x && snake[i].y === head.y) {
            gameOver();
            return;
        }
    }
    
    // æ·»åŠ æ–°çš„å¤´éƒ¨
    snake.unshift(head);
    
    // æ£€æŸ¥æ˜¯å¦åƒåˆ°é£Ÿç‰©
    let ate = false;
    
    // æ£€æŸ¥æ˜¯å¦åƒåˆ°æ™®é€šé£Ÿç‰©
    if (head.x === food.x && head.y === food.y) {
        // å¢åŠ åˆ†æ•°
        snakeScore += snakeFoodValue;
        updateSnakeScore();
        
        // ç”Ÿæˆæ–°çš„é£Ÿç‰©
        generateFood();
        ate = true;
        
        // æ’­æ”¾åƒé£Ÿç‰©çš„åŠ¨ç”»æ•ˆæœ
        playEatAnimation();
    }
    
    // æ£€æŸ¥æ˜¯å¦åƒåˆ°ç‰¹æ®Šé£Ÿç‰©
    if (specialFood && head.x === specialFood.x && head.y === specialFood.y) {
        // å¢åŠ åˆ†æ•°
        snakeScore += specialFood.value;
        updateSnakeScore();
        
        // æ¸…é™¤ç‰¹æ®Šé£Ÿç‰©è®¡æ—¶å™¨
        if (specialFoodTimer) {
            clearTimeout(specialFoodTimer);
            specialFoodTimer = null;
        }
        
        specialFood = null;
        ate = true;
        
        // æ’­æ”¾åƒç‰¹æ®Šé£Ÿç‰©çš„åŠ¨ç”»æ•ˆæœ
        playSpecialEatAnimation();
    }
    
    // å¦‚æœæ²¡æœ‰åƒåˆ°é£Ÿç‰©ï¼Œç§»é™¤å°¾éƒ¨
    if (!ate) {
        snake.pop();
    } else {
        // å¦‚æœåƒåˆ°é£Ÿç‰©ï¼Œæ ¹æ®éš¾åº¦å¢åŠ é¢å¤–çš„é•¿åº¦
        for (let i = 1; i < snakeGrowth; i++) {
            const tail = snake[snake.length - 1];
            snake.push({...tail});
        }
    }
    
    // æ¸…é™¤æ£‹ç›˜å¹¶é‡æ–°ç»˜åˆ¶
    clearBoard();
    drawSnake();
    drawFood();
    if (specialFood) drawSpecialFood();
}

function playEatAnimation() {
    // åˆ›å»ºä¸€ä¸ªä¸´æ—¶å…ƒç´ æ˜¾ç¤ºå¾—åˆ†åŠ¨ç”»
    const scoreAnim = document.createElement('div');
    scoreAnim.textContent = `+${snakeFoodValue}`;
    scoreAnim.style.position = 'absolute';
    scoreAnim.style.left = (food.x * cellSize) + 'px';
    scoreAnim.style.top = (food.y * cellSize) + 'px';
    scoreAnim.style.color = '#4CAF50';
    scoreAnim.style.fontWeight = 'bold';
    scoreAnim.style.fontSize = '16px';
    scoreAnim.style.zIndex = '100';
    scoreAnim.style.animation = 'fadeUp 1s forwards';
    
    // æ·»åŠ åŠ¨ç”»æ ·å¼
    const style = document.createElement('style');
    style.textContent = `
        @keyframes fadeUp {
            0% { opacity: 1; transform: translateY(0); }
            100% { opacity: 0; transform: translateY(-20px); }
        }
    `;
    document.head.appendChild(style);
    
    // æ·»åŠ åˆ°æ£‹ç›˜
    const board = document.getElementById('snake-board');
    board.appendChild(scoreAnim);
    
    // åŠ¨ç”»ç»“æŸåç§»é™¤å…ƒç´ 
    setTimeout(() => {
        board.removeChild(scoreAnim);
        document.head.removeChild(style);
    }, 1000);
}

function playSpecialEatAnimation() {
    // åˆ›å»ºä¸€ä¸ªä¸´æ—¶å…ƒç´ æ˜¾ç¤ºå¾—åˆ†åŠ¨ç”»
    const scoreAnim = document.createElement('div');
    scoreAnim.textContent = `+${specialFood.value}`;
    scoreAnim.style.position = 'absolute';
    scoreAnim.style.left = (specialFood.x * cellSize) + 'px';
    scoreAnim.style.top = (specialFood.y * cellSize) + 'px';
    scoreAnim.style.color = '#E91E63';
    scoreAnim.style.fontWeight = 'bold';
    scoreAnim.style.fontSize = '20px';
    scoreAnim.style.zIndex = '100';
    scoreAnim.style.animation = 'specialFadeUp 1.5s forwards';
    
    // æ·»åŠ åŠ¨ç”»æ ·å¼
    const style = document.createElement('style');
    style.textContent = `
        @keyframes specialFadeUp {
            0% { opacity: 1; transform: translateY(0) scale(1); }
            50% { opacity: 1; transform: translateY(-10px) scale(1.5); }
            100% { opacity: 0; transform: translateY(-30px) scale(1); }
        }
    `;
    document.head.appendChild(style);
    
    // æ·»åŠ åˆ°æ£‹ç›˜
    const board = document.getElementById('snake-board');
    board.appendChild(scoreAnim);
    
    // åŠ¨ç”»ç»“æŸåç§»é™¤å…ƒç´ 
    setTimeout(() => {
        board.removeChild(scoreAnim);
        document.head.removeChild(style);
    }, 1500);
}

function changeSnakeDirection(key) {
    // é˜²æ­¢180åº¦è½¬å‘
    switch (key) {
        case 'ArrowUp':
            if (direction !== 'down') direction = 'up';
            break;
        case 'ArrowDown':
            if (direction !== 'up') direction = 'down';
            break;
        case 'ArrowLeft':
            if (direction !== 'right') direction = 'left';
            break;
        case 'ArrowRight':
            if (direction !== 'left') direction = 'right';
            break;
    }
}

function gameOver() {
    pauseSnakeGame();
    
    // åˆ›å»ºæ¸¸æˆç»“æŸåŠ¨ç”»
    const gameOverDiv = document.createElement('div');
    gameOverDiv.style.position = 'absolute';
    gameOverDiv.style.top = '50%';
    gameOverDiv.style.left = '50%';
    gameOverDiv.style.transform = 'translate(-50%, -50%)';
    gameOverDiv.style.backgroundColor = 'rgba(0, 0, 0, 0.8)';
    gameOverDiv.style.color = 'white';
    gameOverDiv.style.padding = '20px';
    gameOverDiv.style.borderRadius = '10px';
    gameOverDiv.style.textAlign = 'center';
    gameOverDiv.style.zIndex = '100';
    gameOverDiv.style.animation = 'fadeIn 0.5s';
    gameOverDiv.innerHTML = `
        <h2>æ¸¸æˆç»“æŸ</h2>
        <p>ä½ çš„åˆ†æ•°: ${snakeScore}</p>
        <p>è›‡çš„é•¿åº¦: ${snake.length}</p>
        <button id="restart-btn" style="padding: 8px 16px; background-color: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; margin-top: 10px;">é‡æ–°å¼€å§‹</button>
    `;
    
    // æ·»åŠ åŠ¨ç”»æ ·å¼
    const style = document.createElement('style');
    style.textContent = `
        @keyframes fadeIn {
            from { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
            to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        }
    `;
    document.head.appendChild(style);
    
    // æ·»åŠ åˆ°æ£‹ç›˜
    const board = document.getElementById('snake-board');
    board.appendChild(gameOverDiv);
    
    // æ·»åŠ é‡æ–°å¼€å§‹æŒ‰é’®äº‹ä»¶
    document.getElementById('restart-btn').addEventListener('click', function() {
        board.removeChild(gameOverDiv);
        document.head.removeChild(style);
        resetSnakeGame();
    });
}

// è®¾ç½®è§¦æ‘¸æ§åˆ¶
function setupTouchControls() {
    // è·å–è§¦æ‘¸æ§åˆ¶æŒ‰é’®
    const upBtn = document.getElementById('up-btn');
    const downBtn = document.getElementById('down-btn');
    const leftBtn = document.getElementById('left-btn');
    const rightBtn = document.getElementById('right-btn');
    const board = document.getElementById('snake-board');
    
    // æ·»åŠ æŒ‰é’®ç‚¹å‡»äº‹ä»¶
    if (upBtn) {
        upBtn.addEventListener('click', function() {
            if (snakeGameRunning) {
                changeSnakeDirection('ArrowUp');
            }
        });
    }
    
    if (downBtn) {
        downBtn.addEventListener('click', function() {
            if (snakeGameRunning) {
                changeSnakeDirection('ArrowDown');
            }
        });
    }
    
    if (leftBtn) {
        leftBtn.addEventListener('click', function() {
            if (snakeGameRunning) {
                changeSnakeDirection('ArrowLeft');
            }
        });
    }
    
    if (rightBtn) {
        rightBtn.addEventListener('click', function() {
            if (snakeGameRunning) {
                changeSnakeDirection('ArrowRight');
            }
        });
    }
    
    // æ·»åŠ è§¦æ‘¸æ»‘åŠ¨äº‹ä»¶
    if (board) {
        let touchStartX = 0;
        let touchStartY = 0;
        
        board.addEventListener('touchstart', function(e) {
            touchStartX = e.touches[0].clientX;
            touchStartY = e.touches[0].clientY;
        }, false);
        
        board.addEventListener('touchmove', function(e) {
            e.preventDefault(); // é˜²æ­¢é¡µé¢æ»šåŠ¨
        }, false);
        
        board.addEventListener('touchend', function(e) {
            if (!snakeGameRunning) return;
            
            const touchEndX = e.changedTouches[0].clientX;
            const touchEndY = e.changedTouches[0].clientY;
            
            const diffX = touchEndX - touchStartX;
            const diffY = touchEndY - touchStartY;
            
            // åˆ¤æ–­æ»‘åŠ¨æ–¹å‘
            if (Math.abs(diffX) > Math.abs(diffY)) {
                // æ°´å¹³æ»‘åŠ¨
                if (diffX > 0) {
                    changeSnakeDirection('ArrowRight');
                } else {
                    changeSnakeDirection('ArrowLeft');
                }
            } else {
                // å‚ç›´æ»‘åŠ¨
                if (diffY > 0) {
                    changeSnakeDirection('ArrowDown');
                } else {
                    changeSnakeDirection('ArrowUp');
                }
            }
        }, false);
    }
}
    </script>
</body>
</html>